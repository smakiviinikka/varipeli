<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stroop-v√§ripeli</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 10px;
    }

    h1 {
      font-size: clamp(28px, 6vw, 40px);
      margin-bottom: 10px;
    }

    #instructions {
      font-weight: bold;
      font-size: clamp(16px, 4vw, 20px);
      margin-bottom: 15px;
      color: #333;
    }

    #score, #timerText {
      font-size: clamp(16px, 4vw, 20px);
      margin-bottom: 8px;
    }

    #word {
      font-size: clamp(32px, 10vw, 52px);
      font-weight: bold;
      margin: 25px 0;
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      max-width: 500px;
      margin: 0 auto;
    }

    button {
      padding: 18px;
      font-size: clamp(16px, 4vw, 20px);
      cursor: pointer;
    }

    #timeBarContainer {
      width: 90%;
      height: 18px;
      background: #ddd;
      margin: 25px auto;
      border-radius: 10px;
      overflow: hidden;
    }

    #timeBar {
      height: 100%;
      background: #4caf50;
      transition: width 0.1s linear;
    }

    #gameOver {
      font-size: clamp(18px, 5vw, 26px);
      font-weight: bold;
      margin-top: 25px;
    }

    #retryButton {
      margin-top: 15px;
      padding: 12px 25px;
      font-size: 18px;
      display: none;
    }

    #finalMessage {
      font-size: clamp(16px, 4vw, 20px);
      margin-top: 8px;
      color: #444;
    }

    #logoFooter {
      margin-top: 40px;
    }

    #logoFooter span {
      color: #4caf50;
      font-weight: bold;
    }

    #logoFooter .logoText {
      font-size: 20px; /* Logo isompi */
      font-weight: bold;
    }

    #logoFooter .collabLabel {
      font-size: 16px;
      color: #666;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

  <h1>Stroop-v√§ripeli</h1>
  <div id="instructions">
    Napauta sit√§ v√§ri√§, jolla alla oleva teksti on kirjoitettu.
  </div>

  <div id="score">Pisteet: 0 / 16</div>
  <div id="timerText"></div>

  <div id="word"></div>

  <div class="buttons">
    <button>PUNAINEN</button>
    <button>SININEN</button>
    <button>VIHRE√Ñ</button>
    <button>KELTAINEN</button>
  </div>

  <div id="timeBarContainer">
    <div id="timeBar"></div>
  </div>

  <div id="gameOver"></div>
  <div id="finalMessage"></div>
  <button id="retryButton" onclick="startGame()">Yrit√§ uudelleen</button>

  <div id="logoFooter">
    <div class="collabLabel">Yhteisty√∂ss√§:</div>
    <div class="logoText">Sami <span>√ó</span> ChatGPT</div>
  </div>

  <script>
    const basicWordColors = [
      { name: "PUNAINEN", value: "red" },
      { name: "SININEN", value: "blue" },
      { name: "VIHRE√Ñ", value: "green" },
      { name: "KELTAINEN", value: "yellow" }
    ];

    const extraColors = [
      { name: "RUSKEA", value: "brown" },
      { name: "VIOLETTI", value: "purple" }
    ];

    const answerColors = [...basicWordColors];

    const timeLevels = [
      5,5,4,4,3,3,2.5,2.5,2,2,1.5,1.5,1,1,0.5,0.5
    ];

    let index, score, correctColor;
    let timer, timeLeft, maxTime, running;

    const buttons = document.querySelectorAll(".buttons button");

    function startGame() {
      index = 0;
      score = 0;
      running = true;

      document.getElementById("retryButton").style.display = "none";
      document.getElementById("gameOver").textContent = "";
      document.getElementById("finalMessage").textContent = "";

      updateScore();
      nextWord();
    }

    function nextWord() {
      if (!running) return;

      if (index >= timeLevels.length) {
        winGame();
        return;
      }

      const wordPool = index < 2 ? basicWordColors : [...basicWordColors, ...extraColors];
      const word = wordPool[Math.floor(Math.random() * wordPool.length)];

      const colorPool = index < 2 ? basicWordColors : [...basicWordColors, ...extraColors];
      const color = colorPool[Math.floor(Math.random() * colorPool.length)];
      correctColor = color.value;

      document.getElementById("word").textContent = word.name;
      document.getElementById("word").style.color = color.value;

      let buttonColors;
      if(index < 2){
        buttonColors = [...answerColors];
      } else {
        buttonColors = shuffleArray([...basicWordColors, ...extraColors]);
        if(!buttonColors.slice(0,4).some(b => b.value === correctColor)){
          buttonColors[0] = colorPool.find(b => b.value === correctColor);
        }
        buttonColors = buttonColors.slice(0,4);
      }

      buttons.forEach((btn,i)=>{
        btn.textContent = buttonColors[i].name;
        btn.onclick = ()=>answer(buttonColors[i].value);
      });

      maxTime = timeLevels[index];
      timeLeft = maxTime;
      startTimer();
    }

    function shuffleArray(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function startTimer() {
      updateTimer();
      timer = setInterval(() => {
        timeLeft -= 0.1;
        if (timeLeft <= 0) {
          endGame("Aika loppui! üòµ");
        }
        updateTimer();
      },100);
    }

    function updateTimer() {
      document.getElementById("timerText").textContent =
        `Aikaa: ${Math.max(timeLeft,0).toFixed(1)} s`;
      document.getElementById("timeBar").style.width =
        (timeLeft/maxTime)*100 + "%";
    }

    function answer(choice){
      if(!running) return;
      clearInterval(timer);

      if(choice === correctColor){
        score++;
        index++;
        updateScore();
        nextWord();
      } else {
        endGame("V√§√§r√§ vastaus! ‚ùå");
      }
    }

    function updateScore(){
      document.getElementById("score").textContent = `Pisteet: ${score} / 16`;

      const storedHigh = localStorage.getItem('highscore');
      if(!storedHigh || score>storedHigh){
        localStorage.setItem('highscore',score);
      }
    }

    function endGame(message){
      running=false;
      clearInterval(timer);
      document.getElementById("word").textContent="";
      document.getElementById("gameOver").textContent = message;
      
      let extra = score >= 10 ? " (Oho! Aika kovat pojot!)" : "";
      document.getElementById("finalMessage").textContent = `Lopulliset pisteesi: ${score}${extra}`;

      document.getElementById("retryButton").style.display="inline-block";
    }

    function winGame(){
      running=false;
      clearInterval(timer);
      document.getElementById("word").textContent="";
      document.getElementById("gameOver").textContent="üéâ T√§ydet pisteet! Aivoissasi saattaa olla jotakin erikoista‚Ä¶";
      document.getElementById("finalMessage").textContent = `Lopulliset pisteesi: ${score} (Oho! Aika kovat pojot!)`;
      document.getElementById("retryButton").style.display="inline-block";
    }

    startGame();
  </script>

</body>
</html>
